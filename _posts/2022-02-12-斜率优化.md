---
layout: post
title: 斜率优化
subtitle: 可以优秀的解决一些最大值相关的DP
categories: DP
tags: [DP优化]
---

我们考虑一个问题

[玩具装箱](https://www.luogu.com.cn/problem/P3195)

我们很简单可以求出 $O(n^2)$ 的巨简单的做法。

我们设 $f_i$ 表示

$$f_i=min_{j<i}\{f_j+(sum_i-sum_j+i-j-1-L)^2\}$$

我们考虑用 $s_x$ 代替 $sum_x+x$, $L'$ 代替 $L+1$ ,并且把与 $j$ 无关的东西从右边拿到左边。得到：

$$f_i-(s_i-L')=min_{j<i}\{f_j+s_j^2+2s_j(L'-s_i)\}$$

我们考虑用直线的形式转换这个式子。

$$
y=
\begin{cases}
-x,\quad x\leq 0\\
x, \quad x>0
\end{cases}
\tag{1}
$$